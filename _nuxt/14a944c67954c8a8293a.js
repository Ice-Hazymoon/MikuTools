(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{290:function(t,e,n){"use strict";n.r(e),n.d(e,"upload",function(){return c}),n.d(e,"del",function(){return del});var r=n(102),c=function(t,e){return new Promise(function(t,n){var c=new FormData;c.append("smfile",e),c.append("format","json"),r.post("https://sm.ms/api/upload",c).then(t).catch(n)})},del=function(t,e){r.get(e,{auth:!1}).catch(function(){})}},311:function(t,e,n){var content=n(719);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(8).default)("bf9cd96e",content,!0,{sourceMap:!1})},718:function(t,e,n){"use strict";var r=n(311);n.n(r).a},719:function(t,e,n){(t.exports=n(7)(!1)).push([t.i,".search_pic .nya-subtitle{margin-top:.9375rem}.search_pic .preview{max-height:200px;max-height:12.5rem}.search_pic .imginfo{display:inline-block;width:calc(20% - 10px);width:calc(20% - .625rem);vertical-align:top;margin:.3125rem}@media (max-width:1050px){.search_pic .imginfo{width:calc(25% - 10px);width:calc(25% - .625rem)}}@media (max-width:800px){.search_pic .imginfo{width:calc(33.33333% - 10px);width:calc(33.33333% - .625rem)}}@media (max-width:550px){.search_pic .imginfo{width:calc(50% - 10px);width:calc(50% - .625rem)}}.search_pic .imginfo img{width:100%;height:150px;height:9.375rem;-o-object-fit:cover;object-fit:cover}.search_pic .imginfo div{padding:.625rem}.search_pic .imginfo div p{margin-top:0;margin-bottom:.5rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}",""])},811:function(t,e,n){"use strict";n.r(e);var r=n(290),c={name:"SearchPic",head:function(){return this.$store.state.currentTool.head},data:function(){return{n:"",file:null,data:[],smmsdata:null,requestIn:!1}},methods:{handleChange:function(t){var e=t.target.files;if(!e.length)return!1;var n=e[0];n.size/1024/1024>5?(this.n="",this.$modal.show("dialog",{title:"识别失败",text:"ERROR: 请选择大小在5M以内的图片"})):this.file=n},start:function(){return!!this.file&&(!this.requestIn&&(this.data=[],this.smmsdata=null,this.requestIn=!0,void this.uploadImg()))},uploadImg:function(){var t=this;r.upload(this,this.file).then(function(e){t.smmsdata=e.data.data,t.searchPic()}).catch(function(e){t.$modal.show("dialog",{title:"上传图片失败",text:"ERROR: ".concat(e)}),t.requestIn=!1})},searchPic:function(){var t=this;this.$axios.post("/search_pic",{url:this.smmsdata.url}).then(function(e){t.requestIn=!1,t.delImg(),e.data.data.results.length?t.data=e.data.data.results:t.$modal.show("dialog",{title:"识别失败",text:"ERROR: 没有找到相似的图片"})}).catch(function(e){t.$modal.show("dialog",{title:"识别失败",text:"ERROR: ".concat(e)}),t.requestIn=!1,t.delImg()})},delImg:function(){r.del(this,this.smmsdata.delete)}}},l=(n(718),n(1)),component=Object(l.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search_pic"},[n("nya-container",{attrs:{title:"以图搜图"}},[n("div",{staticClass:"inputbtn"},[n("nya-input",{staticClass:"upfile",attrs:{type:"file",accept:"image/*",label:"请选择要识别ACG图片",placeholder:"点击这里上传文件"},on:{change:t.handleChange},model:{value:t.n,callback:function(e){t.n=e},expression:"n"}}),t._v(" "),n("button",{staticClass:"nya-btn",attrs:{type:"button",disabled:t.requestIn},on:{click:t.start}},[t._v("\n                "+t._s(t.requestIn?"获取中":"开始获取")+"\n            ")])],1),t._v(" "),t.smmsdata?n("div",{staticClass:"nya-subtitle"},[t._v("\n            预览\n        ")]):t._e(),t._v(" "),t.smmsdata?n("img",{staticClass:"preview",attrs:{src:t.smmsdata.url,alt:"preview"}}):t._e()]),t._v(" "),t.data.length?n("nya-container",{attrs:{title:"获取成功"}},[t._l(t.data,function(e,r){return[e.data.ext_urls?n("div",{key:r,staticClass:"imginfo"},[n("img",{attrs:{src:e.header.thumbnail,alt:e.data.characters}}),t._v(" "),n("div",[n("p",[t._v("相似度："+t._s(e.header.similarity)+"%")]),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:e.data.characters,expression:"item.data.characters"}],attrs:{title:e.data.characters}},[t._v("\n                        标题："+t._s(e.data.characters)+"\n                    ")]),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:e.data.title,expression:"item.data.title"}],attrs:{title:e.data.title}},[t._v("\n                        标题："+t._s(e.data.title)+"\n                    ")]),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:e.data.creator,expression:"item.data.creator"}],attrs:{title:e.data.creator}},[t._v("\n                        作者："+t._s(e.data.creator)+"\n                    ")]),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:e.data.member_name,expression:"item.data.member_name"}],attrs:{title:e.data.member_name}},[t._v("\n                        作者："+t._s(e.data.member_name)+"\n                    ")]),t._v(" "),t._l(e.data.ext_urls,function(link,e){return n("p",{key:link},[t._v("\n                        链接"+t._s(e+1)+"："),n("a",{attrs:{title:link,href:link,target:"_blank",rel:"noopener noreferrer"}},[t._v("\n                            "+t._s(link)+"\n                        ")])])})],2)]):t._e()]})],2):t._e(),t._v(" "),n("nya-container",{attrs:{title:"Explain"}},[n("ul",{staticClass:"nya-list"},[n("li",[n("b",[t._v("暂时只支持 ACG 图片搜索")])]),t._v(" "),n("li",[t._v("使用 SauceNAO API。")]),t._v(" "),n("li",[t._v("识别成功率取决于上传的图片")]),t._v(" "),n("li",[t._v("多个相同/类似结果是因为返回的数据包含多个相同/类似结果，推荐使用 Pixiv 的数据")])])])],1)},[],!1,null,null,null);e.default=component.exports}}]);