(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{283:function(t,e,n){var r;t.exports=function t(e,n,o){function s(h,u){if(!n[h]){if(!e[h]){var a="function"==typeof r&&r;if(!u&&a)return r(h,!0);if(i)return i(h,!0);var l=new Error("Cannot find module '"+h+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[h]={exports:{}};e[h][0].call(f.exports,function(t){var n=e[h][1][t];return s(n||t)},f,f.exports,t,e,n,o)}return n[h].exports}for(var i="function"==typeof r&&r,h=0;h<o.length;h++)s(o[h]);return s}({1:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function h(t){return"object"==typeof t&&null!==t}function l(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,f,i,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||h(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var d=new Error('Uncaught, unspecified "error" event. ('+e+")");throw d.context=e,d}if(l(n=this._events[t]))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),n.apply(this,f)}else if(h(n))for(f=Array.prototype.slice.call(arguments,1),c=n.slice(),r=c.length,i=0;i<r;i++)c[i].apply(this,f);return!0},r.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?h(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,h(this._events[t])&&!this._events[t].warned&&(n=l(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){if(!o(e))throw TypeError("listener must be a function");var n=!1;function g(){this.removeListener(t,g),n||(n=!0,e.apply(this,arguments))}return g.listener=e,this.on(t,g),this},r.prototype.removeListener=function(t,e){var n,r,l,i;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],l=n.length,r=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(h(n)){for(i=l;i-- >0;)if(n[i]===e||n[i].listener&&n[i].listener===e){r=i;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(o(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(o(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],2:[function(t,e,n){var r,o,h,l,f;f=navigator.userAgent.toLowerCase(),l=navigator.platform.toLowerCase(),r=f.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],h="ie"===r[1]&&document.documentMode,(o={name:"version"===r[1]?r[3]:r[1],version:h||parseFloat("opera"===r[1]&&r[4]?r[4]:r[2]),platform:{name:f.match(/ip(?:ad|od|hone)/)?"ios":(f.match(/(?:webos|android)/)||l.match(/mac|win|linux/)||["other"])[0]}})[o.name]=!0,o[o.name+parseInt(o.version,10)]=!0,o.platform[o.platform.name]=!0,e.exports=o},{}],3:[function(t,e,n){var r,o,h,l={}.hasOwnProperty,f=[].indexOf||function(t){for(var i=0,e=this.length;i<e;i++)if(i in this&&this[i]===t)return i;return-1},c=[].slice;r=t("events").EventEmitter,h=t("./browser.coffee"),o=function(t){var e,n;function r(t){var base,n,r;for(n in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(t),e)r=e[n],null==(base=this.options)[n]&&(base[n]=r)}return function(t,e){for(var n in e)l.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(r,t),e={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},n={delay:500,copy:!1},r.prototype.setOption=function(t,e){if(this.options[t]=e,null!=this._canvas&&("width"===t||"height"===t))return this._canvas[t]=e},r.prototype.setOptions=function(t){var e,n,r;for(e in n=[],t)l.call(t,e)&&(r=t[e],n.push(this.setOption(e,r)));return n},r.prototype.addFrame=function(image,t){var e,r;for(r in null==t&&(t={}),(e={}).transparent=this.options.transparent,n)e[r]=t[r]||n[r];if(null==this.options.width&&this.setOption("width",image.width),null==this.options.height&&this.setOption("height",image.height),"undefined"!=typeof ImageData&&null!==ImageData&&image instanceof ImageData)e.data=image.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&image instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&image instanceof WebGLRenderingContext)t.copy?e.data=this.getContextData(image):e.context=image;else{if(null==image.childNodes)throw new Error("Invalid image");t.copy?e.data=this.getImageData(image):e.image=image}return this.frames.push(e)},r.prototype.render=function(){var t,e,n;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){var t,e,n;for(n=[],t=0,e=this.frames.length;0<=e?t<e:t>e;0<=e?++t:--t)n.push(null);return n}.call(this),e=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(t=0,n=e;0<=n?t<n:t>n;0<=n?++t:--t)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},r.prototype.abort=function(){for(var t;null!=(t=this.activeWorkers.shift());)this.log("killing active worker"),t.terminate();return this.running=!1,this.emit("abort")},r.prototype.spawnWorkers=function(){var t,e,n,r;return t=Math.min(this.options.workers,this.frames.length),function(){n=[];for(var r=e=this.freeWorkers.length;e<=t?r<t:r>t;e<=t?r++:r--)n.push(r);return n}.apply(this).forEach((r=this,function(i){var t;return r.log("spawning worker "+i),(t=new Worker(r.options.workerScript)).onmessage=function(e){return r.activeWorkers.splice(r.activeWorkers.indexOf(t),1),r.freeWorkers.push(t),r.frameFinished(e.data)},r.freeWorkers.push(t)})),t},r.prototype.frameFinished=function(t){var e,n;if(this.log("frame "+t.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[t.index]=t,!0===this.options.globalPalette&&(this.options.globalPalette=t.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(e=1,n=this.freeWorkers.length;1<=n?e<n:e>n;1<=n?++e:--e)this.renderNextFrame();return f.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},r.prototype.finishRendering=function(){var data,t,i,image,e,n,r,o,h,l,f,c,d,v,m,y;for(o=0,v=this.imageParts,e=0,h=v.length;e<h;e++)t=v[e],o+=(t.data.length-1)*t.pageSize+t.cursor;for(o+=t.pageSize-t.cursor,this.log("rendering finished - filesize "+Math.round(o/1e3)+"kb"),data=new Uint8Array(o),c=0,m=this.imageParts,n=0,l=m.length;n<l;n++)for(t=m[n],y=t.data,i=r=0,f=y.length;r<f;i=++r)d=y[i],data.set(d,c),i===t.data.length-1?c+=t.cursor:c+=t.pageSize;return image=new Blob([data],{type:"image/gif"}),this.emit("finished",image,data)},r.prototype.renderNextFrame=function(){var t,e,n;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return t=this.frames[this.nextFrame++],n=this.freeWorkers.shift(),e=this.getTask(t),this.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(n),n.postMessage(e)},r.prototype.getContextData=function(t){return t.getImageData(0,0,this.options.width,this.options.height).data},r.prototype.getImageData=function(image){var t;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(t=this._canvas.getContext("2d")).setFill=this.options.background,t.fillRect(0,0,this.options.width,this.options.height),t.drawImage(image,0,0),this.getContextData(t)},r.prototype.getTask=function(t){var e,n;if(e=this.frames.indexOf(t),n={index:e,last:e===this.frames.length-1,delay:t.delay,transparent:t.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===h.name},null!=t.data)n.data=t.data;else if(null!=t.context)n.data=this.getContextData(t.context);else{if(null==t.image)throw new Error("Invalid frame");n.data=this.getImageData(t.image)}return n},r.prototype.log=function(){var t;if(t=1<=arguments.length?c.call(arguments,0):[],this.options.debug)return console.log.apply(console,t)},r}(r),e.exports=o},{"./browser.coffee":2,events:1}]},{},[3])(3)},284:function(t,e,n){var content=n(625);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(8).default)("7e9c23ee",content,!0,{sourceMap:!1})},624:function(t,e,n){"use strict";var r=n(284);n.n(r).a},625:function(t,e,n){(t.exports=n(7)(!1)).push([t.i,".douyin_text .nya-input{display:block;width:100%}.douyin_text img{max-width:100%}.douyin_text .nya-checkbox{margin:.9375rem 0}",""])},765:function(t,e,n){"use strict";n.r(e);n(65),n(66);var r=n(283);function o(t){var e=t||{};this.word=e.word||"Hello World",this.fontSize=e.fontSize+"px"||!1,this.height=1.5*(e.fontSize||120),this.fontFamily=e.fontFamily||"-apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif",this.font="italic small-caps 900 "+this.fontSize+" "+this.fontFamily,this.offset=this.height*e.offset||.035*this.height,this.x=e.x||0,this.y=e.y||0,this.divideNum=e.divideNum||6,this.seed=e.seed||.51,this.offsetLeft=!0,this.colorLeft=e.colorLeft||"yellow",this.colorRight=e.colorRight||"red",this.color=e.color||"black",this.colorBg=e.colorBg||"black",this.fullscreen=!0,this.dev=!!e.dev,this.gifLength=e.gifLength||10;var n=document.createElement("canvas").getContext("2d");this.ctx=n,this.bgImg=e.bgImg||null}Array.prototype.sum=function(){return this.reduce(function(t,e){return t+e})},o.prototype.random=function(t,e){return Math.random()*(e-t)+t},o.prototype.sin=function(t){for(var e=[],i=0;i<t;i++){var n=100*parseFloat(Math.abs(Math.sin(this.random(0,6))).toString().slice(0,4));e.push(n)}for(var r=e.sum(),o=0;o<e.length;o++)e[o]=e[o]/r;return e},o.prototype.generate=function(){for(var t=[],e=this.x,n=this.width,r=this.height,o=this.seed,i=this.divideNum,h=this.sin(i),l=0;l<i;l++){this.offsetLeft=!this.offsetLeft;var f=0==l?0:t[l-1].get.height+t[l-1].get.y,c=r*h[l];c<=2&&(c=2);var d={get:{x:e,y:f,width:n,height:c},put:{x:e+l*(this.offsetLeft?-1:1)*o,y:f}};t.push(d)}this.divides=t},o.prototype.start=function(){"READY"===this._status?this.update():(this.init(),this.draw(),this.drawBg(),this.generate(),this.copy(),this._status)},o.prototype.update=function(t){this.seed=t||this.seed,"READY"===this._status?(this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.init(),this.draw(),this.drawBg(),this.generate(),this.copy()):this.start()},o.prototype.init=function(){var canvas=this.ctx.canvas,t=this.ctx;t.textBaseline="top",t.font=this.font;var e=this.word;this.width=t.measureText(e).width+2*this.offset,canvas.width=this.width+100,this.x=50,canvas.height=this.height},o.prototype.drawBg=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=this.ctx.canvas.width,t.height=this.ctx.canvas.height,e.fillStyle=this.colorBg;var n=this.word,r=this.offset,o=this.x,h=this.y,l=this.ctx;e.textBaseline="top",e.font=this.font,e.fillStyle=this.color,e.fillText(n,o+r,h+r),e.drawImage(l.canvas,0,0),l.drawImage(t,0,0)},o.prototype.draw=function(){var t=this.word,e=this.offset,n=this.x,r=this.y,o=this.ctx;o.textBaseline="top",o.font=this.font,o.fillStyle=this.colorLeft,o.fillText(t,n-e,r-e),o.fillStyle=this.color,o.fillText(t,n,r),o.globalCompositeOperation="xor",o.fillStyle=this.colorRight,o.fillText(t,n+e,r+e),o.globalCompositeOperation="source-over"},o.prototype.copy=function(){var t=this.divides,e=this.ctx;e.globalCompositeOperation="source-over";for(var n=0;n<t.length;n++){var r=t[n],o=e.getImageData(r.get.x,r.get.y,r.get.width,r.get.height);e.putImageData(o,r.put.x,r.put.y),this.dev&&(e.strokeStyle="red",e.strokeRect(r.get.x,r.get.y,r.get.width,r.get.height))}},o.prototype.toCanvas=function(t){var e=this.ctx,n=e.canvas.width,th=e.canvas.height;t.canvas.width=n,t.canvas.height=th,this.bgImg?t.drawImage(this.bgImg,0,0):t.fillStyle=this.colorBg,t.fillRect(0,0,n,th),t.drawImage(e.canvas,0,th/5)},o.prototype.createFrames=function(t){for(var e=[],n=t||this.gifLength,r=0;r<n;r++){this.update();var o=document.createElement("canvas"),h=o.getContext("2d");this.toCanvas(h),e.push(o)}return this.frames=e,e},o.prototype.createGif=function(t){for(var e=new r({workers:20,quality:10,workerScript:"/js/gif.worker.js"}),n=this.createFrames(),o=0;o<n.length;o++)e.addFrame(n[o],{delay:200});e.on("finished",function(e){t(URL.createObjectURL(e))}),e.render()};var h,l=o,f=n(277);n(252);h=n(253);var c={name:"DouyinText",head:function(){return this.$store.state.currentTool.head},components:{"chrome-picker":f.Chrome,VueSlider:h},data:function(){return{requestIn:!1,colors:"#000",options:{word:"Hello MikuTools",gif:!1,divider:!1,color:"white",colorBg:"#1c0b1b",colorLeft:"#00F5EB",colorRight:"#FF0050",dev:!1,seed:20,fontSize:110},dytext:null,imgUrl:"",gifUrl:""}},watch:{"options.gif":function(t){this.requestIn=!0,t?this.createGif():this.createImg()}},mounted:function(){this.updatePreview()},methods:{init:function(){this.dytext=new l(this.options)},createImg:function(){var t=this,e=document.createElement("canvas"),n=e.getContext("2d");e.width=window.innerWidth,this.dytext.start(),this.dytext.toCanvas(n),e.toBlob(function(e){t.imgUrl=URL.createObjectURL(e),t.requestIn=!1})},createGif:function(){var t=this;this.dytext.createGif(function(e){t.gifUrl=e,t.requestIn=!1})},updatePreview:function(){this.requestIn=!0,this.init(),this.dytext.seed=.05*this.options.seed,this.options.gif?this.createGif():this.createImg()},updateColor:function(t){this.options.colorBg=t.hex8}}},d=(n(624),n(1)),component=Object(d.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"douyin_text"},[n("nya-container",{attrs:{title:"抖音样式文字生成"}},[n("div",{staticClass:"inputbtn"},[n("nya-input",{attrs:{label:"输入要生成的文字",placeholder:"Hello MikuTools",autocomplete:"off",autofocus:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.updatePreview(e)}},model:{value:t.options.word,callback:function(e){t.$set(t.options,"word","string"==typeof e?e.trim():e)},expression:"options.word"}}),t._v(" "),n("button",{staticClass:"nya-btn",attrs:{type:"button",disabled:t.requestIn},on:{click:t.updatePreview}},[t._v("\n                "+t._s(t.requestIn?"生成中":"开始生成")+"\n            ")])],1),t._v(" "),n("nya-checkbox",{attrs:{label:"使用 GIF 格式"},model:{value:t.options.gif,callback:function(e){t.$set(t.options,"gif",e)},expression:"options.gif"}}),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"nya-subtitle"},[t._v("\n            抖动幅度\n        ")]),t._v(" "),n("no-ssr",[n("vue-slider",{attrs:{lazy:"",min:1,max:100},on:{change:t.updatePreview},model:{value:t.options.seed,callback:function(e){t.$set(t.options,"seed",e)},expression:"options.seed"}})],1),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"nya-subtitle"},[t._v("\n            字体大小\n        ")]),t._v(" "),n("no-ssr",[n("vue-slider",{attrs:{lazy:"",min:18,max:200},on:{change:t.updatePreview},model:{value:t.options.fontSize,callback:function(e){t.$set(t.options,"fontSize",e)},expression:"options.fontSize"}})],1),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"nya-subtitle"},[t._v("\n            背景颜色\n        ")]),t._v(" "),n("no-ssr",[n("chrome-picker",{attrs:{value:t.colors},on:{input:t.updateColor}})],1)],1),t._v(" "),(t.options.gif?t.gifUrl:t.imgUrl)?n("nya-container",{staticClass:"preview",attrs:{title:"生成成功"}},[n("a",{attrs:{href:t.options.gif?t.gifUrl:t.imgUrl,target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{src:t.options.gif?t.gifUrl:t.imgUrl,alt:"image"}})])]):t._e(),t._v(" "),n("nya-container",{attrs:{title:"Explain"}},[n("ul",{staticClass:"nya-list"},[n("li",[t._v("如果生成时间过长或生成失败请使用其他浏览器，推荐使用 Chrome")]),t._v(" "),n("li",[t._v("右键另存为下载或长按保存")])])])],1)},[],!1,null,null,null);e.default=component.exports}}]);